# RF SnP to CSV 변환기 - 사용자 매뉴얼 (한글)

## 📋 목차
1. [빠른 시작](#빠른-시작)
2. [화면 설명](#화면-설명)
3. [옵션 설명](#옵션-설명)
4. [파일 요구사항](#파일-요구사항)
5. [문제 해결](#문제-해결)
6. [자주 묻는 질문](#자주-묻는-질문)

---

## 🚀 빠른 시작

### 1단계: 프로그램 실행
```bash
더블클릭: run_gui.bat
```

### 2단계: SnP 파일 선택
**방법 A - 드래그앤드롭:**
1. .s2p 파일이 있는 폴더 열기
2. 파일들 선택해서 프로그램 창으로 드래그

**방법 B - Browse 버튼:**
1. "Browse Folder..." 버튼 클릭
2. 폴더 선택

### 3단계: 옵션 확인 (선택사항)
- ✅ **Frequency filtering** - 권장 (작은 CSV 파일)
- ✅ **Auto-detect band** - 권장 (정확한 Band 인식)
- ☐ **Include full sweep** - 전체 주파수 필요할 때만

### 4단계: 출력 경로 설정
- 기본값: `바탕화면/RF_Output.csv`
- 변경: "Browse..." 클릭

### 5단계: 변환 시작
1. **"START CONVERSION"** 버튼 클릭
2. 진행 상황 확인
3. 완료!

### 6단계: 결과 확인
- **Open CSV**: 엑셀에서 결과 파일 열기
- **Open Folder**: 파일 위치 열기
- **Convert More**: 다시 변환하기

---

## 🖥️ 화면 설명

### 메인 창 구성

```
┌─────────────────────────────────────────┐
│  RF SnP to CSV Converter                │
├─────────────────────────────────────────┤
│  [파일 선택 영역]                        │
│  • 드래그앤드롭 영역                     │
│  • Browse Folder 버튼                   │
│  • 파일 개수 및 크기 표시                │
├─────────────────────────────────────────┤
│  [측정 타입]                             │
│  ◉ Rx Gain Measurement (현재 지원)      │
│  ○ Tx Power (개발 예정)                 │
├─────────────────────────────────────────┤
│  [변환 옵션]                             │
│  ☑ Frequency filtering                 │
│  ☑ Auto-detect band                    │
│  ☐ Include full sweep                  │
├─────────────────────────────────────────┤
│  [출력 설정]                             │
│  출력 경로 입력란                        │
│  Browse 버튼                            │
├─────────────────────────────────────────┤
│  [START CONVERSION] (녹색 버튼)         │
├─────────────────────────────────────────┤
│  [진행 상황]                             │
│  프로그레스바: 0-100%                    │
│  현재 파일: filename.s2p                │
│  파일 카운터: 15/84                     │
├─────────────────────────────────────────┤
│  [변환 결과]                             │
│  ✅ 성공/❌ 실패 메시지                  │
│  • 처리된 파일: 84/84                    │
│  • 생성된 행: 5,040                      │
│  • 출력 크기: 420 KB                     │
│  • 성공률: 100%                          │
│                                          │
│  [Open CSV] [Open Folder] [Convert More]│
└─────────────────────────────────────────┘
```

---

## ⚙️ 옵션 설명

### 1. Frequency Filtering (주파수 필터링)
**기본값: ✅ 활성화**

| 설정 | 설명 | 결과 |
|------|------|------|
| **활성화** | Band별 주파수만 포함 | 작은 CSV (~400 KB) |
| **비활성화** | 전체 8505개 주파수 포함 | 큰 CSV (~50 MB) |

**예시:**
- 파일: `X_ANT1_B1@1_(G0H).s2p` (Band 1)
- 활성화: 2110-2170 MHz만 (~60개 포인트)
- 비활성화: 1 MHz - 8.5 GHz 전체 (8505개 포인트)

**권장사항:**
✅ **활성화 유지** (전체 주파수가 꼭 필요한 경우가 아니면)

---

### 2. Auto-detect Band from Filename (파일명에서 Band 자동 인식)
**기본값: ✅ 활성화**

| 설정 | 설명 | 동작 |
|------|------|------|
| **활성화** | 파일명에서 Band 추출 (예: "B1", "B7") | 정확한 Band 할당 |
| **비활성화** | 자동 인식 안 함 | Band = "Unknown" |

**파일명 형식:**
```
X_ANT1_B1@1_(G0H).s2p
       ^^
       Band: B1
```

**권장사항:**
✅ **활성화 유지** (정확한 Band 필터링을 위해)

---

### 3. Include Full Frequency Sweep (전체 주파수 포함)
**기본값: ☐ 비활성화**

| 설정 | 포인트/파일 | CSV 크기 (84 files) | 용도 |
|------|-------------|---------------------|------|
| **비활성화** | ~60개 | ~400 KB | 일반 RF 분석 |
| **활성화** | 8505개 | ~50 MB | 연구, 전체 스펙트럼 분석 |

**경고:**
⚠️ 활성화 시 CSV 파일이 **100배 이상 커집니다!**

---

## 📁 파일 요구사항

### 지원하는 파일 형식
- ✅ `.s1p` ~ `.s12p` - 1-port ~ 12-port S-parameter
- ✅ `.s2p` - 2-port (가장 일반적)
- ✅ `.s8p`, `.s9p`, `.s10p`, `.s11p`, `.s12p` - 다중 포트 지원
- ✅ 대소문자 구분 없음 (`.S2P`, `.s2p` 모두 인식)

**지원 범위**: s1p, s2p, s3p, s4p, s5p, s6p, s7p, s8p, s9p, s10p, s11p, s12p

### SnP 파일이 아닌 경우?
**질문:** 폴더에 CSV/PNG/TXT 파일이 있으면?

**답변:** 자동으로 **무시**됩니다. SnP 파일만 처리됩니다.

**예시:**
```
target/
├── X_ANT1_B1@1_(G0H).s2p  ✅ 처리됨
├── data.csv                ❌ 무시됨
├── chart.png               ❌ 무시됨
└── notes.txt               ❌ 무시됨
```

### 파일명 형식 (권장)
```
X_<입력포트>_<Band>@<출력포트>_(<LNA상태>).s2p

예시:
X_ANT1_B1@1_(G0H).s2p
X_ANT2_B7@2_(G3).s2p
X_ANT1_B1[B7]@1_(G0).s2p  (CA: Carrier Aggregation)
```

**추출되는 정보:**
- 입력 포트: ANT1, ANT2, ANT3, ANT4
- Band: B1, B7, B41 등
- 출력 포트: @1→RXOUT1, @2→RXOUT2 등
- LNA 상태: G0, G0H, G1, G2, G3, G4, G5

---

## 🐛 문제 해결

### 문제 1: 프로그램이 실행되지 않음
**증상:** 더블클릭해도 아무 반응 없음

**해결:**
```bash
# PyQt6 설치
cd C:\Project\html_exporter
.venv\Scripts\pip.exe install PyQt6

# 다시 실행
cd rf_converter
run_gui.bat
```

---

### 문제 2: 드래그 후 파일이 인식 안 됨
**증상:** "No files selected" 표시

**원인:**
1. 폴더에 `.s2p` 파일이 없음
2. 파일 확장자가 잘못됨

**해결:**
- 파일 확장자 확인 (`.s1p`, `.s2p`, `.s3p`, `.s4p`만 가능)
- 드래그 대신 "Browse Folder..." 사용

---

### 문제 3: 변환 실패
**증상:** 빨간색 에러 메시지

**원인:**
1. 손상된 SnP 파일
2. 잘못된 파일 형식
3. 디스크 공간 부족

**해결:**
1. 에러 메시지에서 문제 파일 확인
2. 문제 파일 제거
3. 나머지 파일로 다시 시도

---

### 문제 4: CSV 파일이 너무 큼
**증상:** CSV 파일이 50+ MB

**원인:** "Include full frequency sweep" 활성화됨

**해결:**
1. "Include full frequency sweep" 체크 해제
2. "Frequency filtering" 활성화 유지
3. 다시 변환

---

### 문제 5: CSV에 Band가 잘못 표시됨
**증상:** Band 컬럼에 "Unknown"

**원인:** 파일명 형식이 맞지 않음

**해결:**
1. "Auto-detect band" 활성화 확인
2. 파일명 형식 확인: `X_ANT1_B1@1_(G0H).s2p`
3. Band는 B1, B7, B41 형식이어야 함

---

## ❓ 자주 묻는 질문

### Q1: 여러 폴더의 파일을 한 번에 변환할 수 있나요?
**A:** 네! 여러 폴더에서 파일을 드래그하면 누적됩니다.

---

### Q2: 어떤 CSV 형식으로 생성되나요?
**A:** Bellagio 형식 14개 컬럼:
- Freq Type, RAT, Cfg Band, Debug Band, Frequency
- Active RF Path, Gain (dB), Reverse (dB)
- Input RL (dB), Output RL (dB)
- cfg_lna_gain_state, cfg_active_port_1, cfg_active_port_2, ca_config

*(전체 89컬럼 형식은 향후 버전에서 지원 예정)*

---

### Q3: 변환 시간은 얼마나 걸리나요?
**A:** 대략:
- 10개 파일: ~2초
- 50개 파일: ~8초
- 100개 파일: ~15초

*(주파수 필터링 설정에 따라 달라짐)*

---

### Q4: Tx 측정도 변환할 수 있나요?
**A:** 아직 안 됩니다. 현재 지원:
- ✅ Rx Gain Measurement

개발 예정:
- 🔜 Tx Power Measurement
- 🔜 Isolation Measurement

---

### Q5: 출력 CSV 파일은 어디에 저장되나요?
**A:** 기본 위치: `바탕화면/RF_Output.csv`

변경 방법:
1. Output Settings에서 "Browse..." 클릭
2. 원하는 폴더와 파일명 선택

---

### Q6: Band 주파수가 아닌 전체 주파수가 필요하면?
**A:**
1. "Frequency filtering" 체크 해제
2. 또는 "Include full frequency sweep" 체크
3. 큰 CSV 파일 각오 (~50 MB for 84 files)

---

### Q7: 폴더에 CSV, PNG 파일이 있어도 되나요?
**A:** 네! SnP 파일만 자동으로 선택되고, 나머지는 무시됩니다.

**예시:**
```
✅ X_ANT1_B1@1_(G0H).s2p  → 선택됨
❌ data.csv                → 무시됨
❌ chart.png               → 무시됨
```

---

### Q8: "Auto-detect band" 체크 해제하면?
**A:**
- 주파수 필터링이 **비활성화**됩니다
- 전체 8505개 주파수 포인트가 포함됩니다
- CSV 파일이 **100배 이상 커집니다**

**권장:** 특별한 이유가 없으면 **체크 유지**

---

## 📞 지원

문제 발생 시:
1. 이 매뉴얼 먼저 확인
2. 에러 메시지 확인
3. 시스템 관리자에게 문의

---

## 📝 버전 히스토리

### v1.0.0 (2025-01-26)
- ✅ 최초 릴리즈
- ✅ Rx Gain 측정 지원
- ✅ PyQt6 GUI
- ✅ 드래그앤드롭 지원
- ✅ 실시간 진행 상황 표시
- ✅ 주파수 필터링
- ✅ Band 자동 인식

### 개발 예정
- 🔜 Tx Power 측정
- 🔜 Isolation 측정
- 🔜 전체 89컬럼 Bellagio 형식
- 🔜 CLI 도구
- 🔜 배치 처리 스크립트

---

**마지막 업데이트:** 2025-01-26
