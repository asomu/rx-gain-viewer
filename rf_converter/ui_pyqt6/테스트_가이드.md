# PyQt6 GUI 테스트 가이드

## ✅ GUI 실행 성공!

PyQt6 GUI가 성공적으로 실행되었습니다. 모든 IndentationError가 해결되었고, UI가 정상적으로 표시되고 있습니다.

---

## 📋 실행 방법

### 방법 1: 명령줄에서 직접 실행

```bash
cd C:\Project\html_exporter\rf_converter\ui_pyqt6
set PYTHONPATH=..\
C:\Project\html_exporter\.venv\Scripts\python.exe main.py
```

### 방법 2: 간단한 배치 파일 사용

`run_gui.bat` 파일을 만들어서 사용하세요:

```batch
@echo off
cd /d %~dp0
set PYTHONPATH=..\
..\..\..\.venv\Scripts\python.exe main.py
pause
```

---

## 🎯 테스트 항목

### 1. UI 레이아웃 확인 ⭐

**확인 사항**:
- ✅ Browse Folders 버튼과 드래그 영역이 겹치지 않는지
- ✅ Conversion Results 섹션이 **항상 표시**되는지 (빈 상태로)
- ✅ 윈도우가 1080p 화면에 맞는지 (850px 높이)
- ✅ 스크롤이 필요한 경우 정상적으로 작동하는지

**테스트 절차**:
1. GUI 실행
2. "Ready to Convert" 메시지가 Conversion Results 섹션에 표시되는지 확인
3. 3개의 버튼(Open CSV, Open Folder, Convert More)이 보이지만 비활성화되어 있는지 확인
4. 윈도우 크기가 적절한지 확인

### 2. 파일 선택 기능 ⭐

**테스트 케이스 1: 폴더 드래그**
1. 테스트용 SnP 파일이 있는 폴더를 준비
2. 폴더를 드래그 영역에 드롭
3. s1p ~ s12p 파일이 자동으로 감지되는지 확인
4. CSV, PNG 등 다른 파일은 자동으로 필터링되는지 확인

**테스트 케이스 2: Browse Folders 버튼**
1. "Browse Folders" 버튼 클릭
2. 폴더 선택 다이얼로그가 열리는지 확인
3. 폴더 선택 후 파일 목록이 표시되는지 확인

**테스트 케이스 3: 다양한 SnP 파일 형식**
- `.s1p` ~ `.s4p` (기본)
- `.s5p` ~ `.s12p` (확장 지원)
- 대소문자 혼합 (`.S2P`, `.s2p`)

### 3. 변환 프로세스 ⭐⭐⭐

**테스트 절차**:
1. SnP 파일 선택
2. "START CONVERSION" 버튼 클릭
3. **Conversion Results 섹션 동작 확인**:
   - "Converting..." 상태로 변경
   - 버튼은 계속 보이지만 비활성화됨
   - **레이아웃 점프가 없어야 함!**
4. Progress bar 동작 확인
5. 변환 완료 후 결과 표시 확인:
   - "✅ Conversion Successful!" 메시지
   - 파일 처리 통계 (Files Processed, Rows Generated, Output Size, Success Rate)
   - 버튼 활성화 확인

### 4. 결과 버튼 기능

**Open CSV 버튼**:
- 클릭 시 기본 프로그램으로 CSV 파일 열기
- Excel, LibreOffice Calc 등에서 열리는지 확인

**Open Folder 버튼**:
- 클릭 시 출력 파일이 있는 폴더 열기
- Windows Explorer에서 파일이 보이는지 확인

**Convert More 버튼**:
- 클릭 시 UI가 초기 상태로 리셋되는지 확인
- Conversion Results 섹션이 "Ready to Convert" 상태로 돌아가는지 확인

### 5. 옵션 기능

**Frequency filtering**:
- 체크: 대역별 주파수 필터링 적용 (예: B1 → 2110-2170 MHz)
- 체크 해제: 모든 주파수 포함

**Auto-detect band from filename**:
- 체크: 파일명에서 자동으로 대역 감지 (예: `X_ANT1_B1@1_(G0H).s2p`)
- 체크 해제: 주파수 필터링만 적용

**Include full frequency sweep**:
- 체크: 전체 주파수 스윕 포함
- 현재는 비활성화 상태

---

## ⚠️ 알려진 이슈 및 해결 방법

### 이슈 1: ModuleNotFoundError: No module named 'pandas'
**원인**: 가상환경이 활성화되지 않았거나 pandas가 설치되지 않음

**해결**:
```bash
cd C:\Project\html_exporter
.venv\Scripts\activate
pip install pandas numpy PyQt6
```

### 이슈 2: ModuleNotFoundError: No module named 'core'
**원인**: PYTHONPATH가 설정되지 않음

**해결**:
```bash
set PYTHONPATH=..\
```

또는 `run_gui.bat` 파일 사용

### 이슈 3: GUI가 너무 크거나 작게 표시됨
**현재 설정**:
- 윈도우 크기: 750x850px
- 최소 크기: 750x700px
- 최대 크기: 750x900px

**조정이 필요한 경우**: `main_window.py` 파일의 79-81번 라인 수정

---

## 🎨 UX 개선 사항 (완료) ✅

### 1. 레이아웃 안정성
- ✅ Conversion Results 섹션 **항상 표시** (setVisible(False) 제거)
- ✅ 3가지 상태 관리: Empty → Converting → Complete
- ✅ 레이아웃 점프 없음 (높이 고정)

### 2. 윈도우 크기 최적화
- ✅ 850px 높이로 1080p 화면에 최적화
- ✅ QScrollArea 추가로 내용 넘침 방지

### 3. 버튼 항상 표시
- ✅ Open CSV, Open Folder, Convert More 버튼이 항상 보임
- ✅ 상태에 따라 활성화/비활성화만 변경

### 4. 상태별 메시지
- ✅ Empty: "Ready to Convert" (회색)
- ✅ Converting: "Converting..." (파란색)
- ✅ Complete: "✅ Conversion Successful!" (초록색)

---

## 📊 테스트 결과 보고

테스트 완료 후 다음 정보를 확인해주세요:

1. **레이아웃 이슈**: Browse Folders 버튼 겹침, 결과창 잘림 등
2. **기능 이슈**: 변환 실패, 버튼 오작동 등
3. **성능 이슈**: 변환 속도, 대용량 파일 처리 등
4. **UX 이슈**: 사용자 경험상 불편한 점

---

## 🚀 다음 단계

### 완료된 작업 ✅
1. Core 모듈 (100% UI 독립적)
2. PyQt6 UI (레이아웃 안정성 개선)
3. s1p~s12p 지원
4. 한글 매뉴얼

### 남은 작업 📋
1. **Flask UI 구현** (요청하신 부분)
2. **EXE 빌드** (PyInstaller)
3. **Electron UI** (선택사항)

---

**Last Updated**: 2025-10-26
**Status**: PyQt6 GUI 정상 작동 확인 ✅
